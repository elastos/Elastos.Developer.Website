<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Elastos Browser (Trinity) Source: elastos-trinity-plugins-carrier/www/carrier.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.paper.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top navbar-inverse">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Elastos Browser (Trinity)</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-Acceleration.html">Acceleration</a></li><li><a href="module-Accelerometer.html">Accelerometer</a></li><li><a href="module-Camera.html">Camera</a></li><li><a href="module-CameraConstants.html">CameraConstants</a></li><li><a href="module-CameraPopoverHandle.html">CameraPopoverHandle</a></li><li><a href="module-CameraPopoverOptions.html">CameraPopoverOptions</a></li><li><a href="module-Capture.html">Capture</a></li><li><a href="module-Connection.html">Connection</a></li><li><a href="module-Flashlight.html">Flashlight</a></li><li><a href="module-Geolocation.html">Geolocation</a></li><li><a href="module-InAppBrowser.html">InAppBrowser</a></li><li><a href="module-Notification.html">Notification</a></li><li><a href="module-Position.html">Position</a></li><li><a href="module-ScreenOrientation.html">ScreenOrientation</a></li><li><a href="module-Splashscreen.html">Splashscreen</a></li><li><a href="module-StatusBar.html">StatusBar</a></li><li><a href="module-Vibration.html">Vibration</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="Battery.html">Battery</a></li><li><a href="Clipboard.html">Clipboard</a></li><li><a href="Coordinates.html">Coordinates</a></li><li><a href="Device.html">Device</a></li><li><a href="FileReader.html">FileReader</a></li><li><a href="FileSystem.html">FileSystem</a></li><li><a href="FileUploadOptions.html">FileUploadOptions</a></li><li><a href="FileUploadResult.html">FileUploadResult</a></li><li><a href="FileWriter.html">FileWriter</a></li><li><a href="Media.html">Media</a></li><li><a href="PositionError.html">PositionError</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#CaptureAudioOptions">CaptureAudioOptions</a></li><li><a href="global.html#CaptureError">CaptureError</a></li><li><a href="global.html#CaptureImageOptions">CaptureImageOptions</a></li><li><a href="global.html#CaptureVideoOptions">CaptureVideoOptions</a></li><li><a href="global.html#ConfigurationData">ConfigurationData</a></li><li><a href="global.html#cordova">cordova</a></li><li><a href="global.html#DirectoryEntry">DirectoryEntry</a></li><li><a href="global.html#DirectoryReader">DirectoryReader</a></li><li><a href="global.html#Entry">Entry</a></li><li><a href="global.html#File">File</a></li><li><a href="global.html#FileEntry">FileEntry</a></li><li><a href="global.html#FileError">FileError</a></li><li><a href="global.html#Flags">Flags</a></li><li><a href="global.html#MediaFile">MediaFile</a></li><li><a href="global.html#MediaFileData">MediaFileData</a></li><li><a href="global.html#Metadata">Metadata</a></li><li><a href="global.html#namedColors">namedColors</a></li><li><a href="global.html#readFailureCallback">readFailureCallback</a></li><li><a href="global.html#readSuccessCallback">readSuccessCallback</a></li><li><a href="global.html#resolveLocalFileSystemURL">resolveLocalFileSystemURL</a></li><li><a href="global.html#set">set</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		<h1 class="page-title">Source: elastos-trinity-plugins-carrier/www/carrier.js</h1>
    
<section>
    <article>
        <pre
            class="sunlight-highlight-javascript linenums">"use strict";
/*
* Copyright (c) 2018 Elastos Foundation
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/
var exec = cordova.exec;
var CARRIER_CB_NAMES = [
    "onConnection",
    "onReady",
    "onSelfInfoChanged",
    "onFriends",
    "onFriendConnection",
    "onFriendInfoChanged",
    "onFriendPresence",
    "onFriendRequest",
    "onFriendAdded",
    "onFriendRemoved",
    "onFriendMessage",
    "onFriendInviteRequest",
    "onSessionRequest",
    "onGroupInvite",
    "onConnectRequest",
];
var GROUP_CB_NAMES = [
    "onGroupConnected",
    "onGroupMessage",
    "onGroupTitle",
    "onPeerName",
    "onPeerListChanged",
];
var FILE_TRANSFER_CB_NAMES = [
    "onStateChanged",
    "onFileRequest",
    "onPullRequest",
    "onData",
    "onDataFinished",
    "onPending",
    "onResume",
    "onCancel",
];
var STREAM_CB_NAMES = [
    "onStateChanged",
    "onStreamData",
    "onChannelOpen",
    "onChannelOpened",
    "onChannelClose",
    "onChannelData",
    "onChannelPending",
    "onChannelResume",
];
var CARRIER = 1;
var SESSION = 2;
var STREAM = 3;
var FRIEND_INVITE = 4;
var GROUP = 5;
var FILE_TRANSFER = 6;
var StreamImpl = /** @class */ (function () {
    function StreamImpl() {
        this.objId = null;
        this.carrierManager = null;
        this.id = null;
        this.carrier = null;
        this.session = null;
        this.type = null;
        this.callbacks = {
            onStateChanged: null,
            onStreamData: null,
            onChannelOpen: null,
            onChannelOpened: null,
            onChannelClose: null,
            onChannelData: null,
            onChannelPending: null,
            onChannelResume: null,
        };
    }
    StreamImpl.prototype.on = function (name, callback) {
        if (typeof callback != 'function') {
            return false;
        }
        for (var i = 0; i &lt; STREAM_CB_NAMES.length; i++) {
            if (name == STREAM_CB_NAMES[i]) {
                this.callbacks[name] = callback;
                return true;
            }
        }
        return false;
    };
    StreamImpl.prototype.process = function (onSuccess, onError, name, args) {
        var me = this;
        var _onSuccess = function (ret) {
            ret.stream = me;
            if (onSuccess)
                onSuccess(ret);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', name, args);
    };
    StreamImpl.prototype.getTransportInfo = function (onSuccess, onError) {
        this.process(onSuccess, onError, "getTransportInfo", [this.objId]);
    };
    StreamImpl.prototype.write = function (data, onSuccess, onError) {
        this.process(onSuccess, onError, "streamWrite", [this.objId, data]);
    };
    StreamImpl.prototype.openChannel = function (cookie, onSuccess, onError) {
        this.process(onSuccess, onError, "openChannel", [this.objId, cookie]);
    };
    StreamImpl.prototype.closeChannel = function (channel, onSuccess, onError) {
        this.process(onSuccess, onError, "closeChannel", [this.objId, channel]);
    };
    StreamImpl.prototype.writeChannel = function (channel, data, onSuccess, onError) {
        this.process(onSuccess, onError, "writeChannel", [this.objId, channel, data]);
    };
    StreamImpl.prototype.pendChannel = function (channel, onSuccess, onError) {
        this.process(onSuccess, onError, "pendChannel", [this.objId, channel]);
    };
    StreamImpl.prototype.resumeChannel = function (channel, onSuccess, onError) {
        this.process(onSuccess, onError, "resumeChannel", [this.objId, channel]);
    };
    StreamImpl.prototype.openPortForwarding = function (service, protocol, host, port, onSuccess, onError) {
        this.process(onSuccess, onError, "openPortForwarding", [this.objId, service, protocol, host, port]);
    };
    StreamImpl.prototype.closePortForwarding = function (portForwarding, onSuccess, onError) {
        this.process(onSuccess, onError, "closePortForwarding", [this.objId, portForwarding]);
    };
    return StreamImpl;
}());
var SessionImpl = /** @class */ (function () {
    function SessionImpl() {
        this.objId = null;
        this.carrierManager = null;
        this.streams = [];
        this.peer = null;
        this.carrier = null;
    }
    SessionImpl.prototype.process = function (onSuccess, onError, name, args) {
        var me = this;
        exec(function (ret) {
            ret.session = me;
            if (onSuccess)
                onSuccess(ret);
        }, onError, 'CarrierPlugin', name, args);
    };
    // /**
    //  * Get remote peer id.
    //  *
    //  * @param {Function} onSuccess  The function to call when success, the param is a string: The remote peer userid.
    //  * @param {Function} [onError]  The function to call when error, the param is a string. Or set to null.
    //  */
    // getPeer: function (onSuccess, onError) {
    //     this.process(onSuccess, onError, "getPeer", [this.objId]);
    // },
    SessionImpl.prototype.close = function (onSuccess, onError) {
        this.process(onSuccess, onError, "sessionClose", [this.objId]);
    };
    SessionImpl.prototype.request = function (handler, onSuccess, onError) {
        var handlerId = 0;
        if (typeof handler == "function") {
            handlerId = this.carrierManager.addSessionRequestCompleteCB(handler, this);
        }
        this.process(onSuccess, onError, "sessionRequest", [this.objId, handlerId]);
    };
    SessionImpl.prototype.replyRequest = function (status, reason, onSuccess, onError) {
        this.process(onSuccess, onError, "sessionReplyRequest", [this.objId, status, reason]);
    };
    SessionImpl.prototype.start = function (sdp, onSuccess, onError) {
        this.process(onSuccess, onError, "sessionStart", [this.objId, sdp]);
    };
    SessionImpl.prototype.addStream = function (type, options, callbacks, onSuccess, onError) {
        var stream = new StreamImpl();
        var me = this;
        var _onSuccess = function (ret) {
            stream.type = type;
            stream.objId = ret.objId;
            stream.id = ret.id;
            stream.carrierManager = me.carrierManager;
            stream.carrier = me.carrier;
            stream.session = me;
            me.streams[stream.id] = stream;
            me.carrierManager.streams[stream.objId] = stream;
            if (onSuccess)
                onSuccess(stream);
        };
        if (callbacks) {
            for (var i = 0; i &lt; STREAM_CB_NAMES.length; i++) {
                var name = STREAM_CB_NAMES[i];
                stream.callbacks[name] = callbacks[name];
            }
        }
        exec(_onSuccess, onError, 'CarrierPlugin', 'addStream', [this.objId, type, options]);
    };
    SessionImpl.prototype.removeStream = function (stream, onSuccess, onError) {
        if (stream == this.streams[stream.id]) {
            var me = this;
            var _onSuccess = function (ret) {
                ret.session = me;
                me.streams[stream.id] = null;
                me.carrierManager.streams[stream.objId] = null;
                if (onSuccess)
                    onSuccess(ret);
            };
            exec(_onSuccess, onError, 'CarrierPlugin', "removeStream", [this.objId, stream.objId]);
        }
        else {
            onError("This stream doesn't belong to the session!");
        }
    };
    SessionImpl.prototype.addService = function (service, protocol, host, port, onSuccess, onError) {
        this.process(onSuccess, onError, "addService", [this.objId, service, protocol, host, port]);
    };
    SessionImpl.prototype.removeService = function (service, onSuccess, onError) {
        this.process(onSuccess, onError, "removeService", [this.objId, service]);
    };
    return SessionImpl;
}());
var CarrierImpl = /** @class */ (function () {
    function CarrierImpl() {
        this.objId = null;
        this.carrierManager = null;
        this.nodeId = null;
        this.userId = null;
        this.address = null;
        this._nospam = null;
        this._presence = null;
        this.callbacks = {
            onConnection: null,
            onReady: null,
            onSelfInfoChanged: null,
            onFriends: null,
            onFriendConnection: null,
            onFriendInfoChanged: null,
            onFriendPresence: null,
            onFriendRequest: null,
            onFriendAdded: null,
            onFriendRemoved: null,
            onFriendMessage: null,
            onFriendInviteRequest: null,
            onSessionRequest: null,
            onGroupInvite: null,
            onConnectRequest: null,
        };
    }
    Object.defineProperty(CarrierImpl.prototype, "nospam", {
        get: function () {
            return this._nospam;
        },
        /** @property {number} nospam The nospam for Carrier address is used to eliminate spam friend. **/
        set: function (value) {
            var me = this;
            var success = function (ret) {
                me._nospam = value;
            };
            this.process(success, null, "setNospam", [this.objId, value]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CarrierImpl.prototype, "presence", {
        get: function () {
            return this._presence;
        },
        /** @property {number} presence Presence status. **/
        set: function (value) {
            var me = this;
            var success = function (ret) {
                me._presence = value;
            };
            this.process(success, null, "setPresence", [this.objId, value]);
        },
        enumerable: true,
        configurable: true
    });
    CarrierImpl.prototype.on = function (name, callback) {
        if (typeof callback != 'function') {
            return false;
        }
        for (var i = 0; i &lt; CARRIER_CB_NAMES.length; i++) {
            if (name == CARRIER_CB_NAMES[i]) {
                this.callbacks[name] = callback;
                return true;
            }
        }
        return false;
    };
    CarrierImpl.prototype.process = function (onSuccess, onError, name, args) {
        var me = this;
        var _onSuccess = function (ret) {
            ret.carrier = me;
            if (onSuccess)
                onSuccess(ret);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', name, args);
    };
    CarrierImpl.prototype.start = function (iterateInterval, onSuccess, onError) {
        this.process(onSuccess, onError, "carrierStart", [this.objId, iterateInterval]);
    };
    CarrierImpl.prototype.getSelfInfo = function (onSuccess, onError) {
        this.process(onSuccess, onError, "getSelfInfo", [this.objId]);
    };
    CarrierImpl.prototype.setSelfInfo = function (name, value, onSuccess, onError) {
        this.process(onSuccess, onError, "setSelfInfo", [this.objId, name, value]);
    };
    CarrierImpl.prototype.isReady = function (onSuccess, onError) {
        this.process(onSuccess, onError, "isReady", [this.objId]);
    };
    CarrierImpl.prototype.getFriends = function (onSuccess, onError) {
        this.process(onSuccess, onError, "getFriends", [this.objId]);
    };
    CarrierImpl.prototype.getFriend = function (userId, onSuccess, onError) {
        this.process(onSuccess, onError, "getFriend", [this.objId, userId]);
    };
    CarrierImpl.prototype.labelFriend = function (userId, label, onSuccess, onError) {
        this.process(onSuccess, onError, "labelFriend", [this.objId, userId, label]);
    };
    CarrierImpl.prototype.isFriend = function (userId, onSuccess, onError) {
        this.process(onSuccess, onError, "isFriend", [this.objId, userId]);
    };
    CarrierImpl.prototype.addFriend = function (address, hello, onSuccess, onError) {
        this.process(onSuccess, onError, "addFriend", [this.objId, address, hello]);
    };
    CarrierImpl.prototype.acceptFriend = function (userId, onSuccess, onError) {
        this.process(onSuccess, onError, "acceptFriend", [this.objId, userId]);
    };
    CarrierImpl.prototype.removeFriend = function (userId, onSuccess, onError) {
        this.process(onSuccess, onError, "removeFriend", [this.objId, userId]);
    };
    CarrierImpl.prototype.sendFriendMessage = function (to, message, onSuccess, onError) {
        this.process(onSuccess, onError, "sendFriendMessage", [this.objId, to, message]);
    };
    CarrierImpl.prototype.inviteFriend = function (to, data, handler, onSuccess, onError) {
        var handlerId = 0;
        if (typeof handler == "function") {
            handlerId = this.carrierManager.addFriendInviteResponseCB(handler, this);
        }
        this.process(onSuccess, onError, "inviteFriend", [this.objId, to, data, handlerId]);
    };
    CarrierImpl.prototype.replyFriendInvite = function (to, status, reason, data, onSuccess, onError) {
        this.process(onSuccess, onError, "replyFriendInvite", [this.objId, to, status, reason, data]);
    };
    CarrierImpl.prototype.newGroup = function (callbacks, onSuccess, onError) {
        var _onSuccess = function (ret) {
            var group = new GroupImpl();
            group.groupId = ret.groupId;
            this.carrierManager.groups[group.groupId] = group;
            if (typeof (callbacks) != "undefined" &amp;&amp; callbacks != null) {
                for (var i = 0; i &lt; GROUP_CB_NAMES.length; i++) {
                    var name = GROUP_CB_NAMES[i];
                    this.carrierManager.groups[group.groupId].callbacks[name] = callbacks[name];
                }
            }
            if (onSuccess)
                onSuccess(group);
        };
        this.process(_onSuccess, onError, "createGroup", [this.objId]);
    };
    CarrierImpl.prototype.groupJoin = function (friendId, cookieCode, callbacks, onSuccess, onError) {
        var me = this;
        var _onSuccess = function (ret) {
            var group = new GroupImpl();
            group.groupId = ret.groupId;
            me.carrierManager.groups[group.groupId] = group;
            if (typeof (callbacks) != "undefined" &amp;&amp; callbacks != null) {
                for (var i = 0; i &lt; GROUP_CB_NAMES.length; i++) {
                    var name = GROUP_CB_NAMES[i];
                    me.carrierManager.groups[group.groupId].callbacks[name] = callbacks[name];
                }
            }
            if (onSuccess)
                onSuccess(group);
        };
        this.process(_onSuccess, onError, "joinGroup", [this.objId, friendId, cookieCode]);
    };
    CarrierImpl.prototype.groupLeave = function (group, onSuccess, onError) {
        var me = this;
        var _onSuccess = function (ret) {
            delete me.carrierManager.groups[group.groupId];
            if (onSuccess)
                onSuccess(group);
        };
        this.process(_onSuccess, onError, "leaveGroup", [this.objId, group.groupId]);
    };
    CarrierImpl.prototype.getGroups = function (onSuccess, onError) {
        var groups = [];
        var index = 0;
        for (var i in this.carrierManager.groups) {
            groups[index] = this.carrierManager.groups[i];
            index = index + 1;
        }
        if (onSuccess)
            onSuccess(groups);
    };
    CarrierImpl.prototype.newFileTransfer = function (to, fileTransferInfo, callbacks, onSuccess, onError) {
        var me = this;
        var _onSuccess = function (ret) {
            var fileTransfer = new FileTransferImpl();
            fileTransfer.fileTransferId = ret.fileTransferId;
            me.carrierManager.fileTransfers[fileTransfer.fileTransferId] = fileTransfer;
            if (typeof (callbacks) != "undefined" &amp;&amp; callbacks != null) {
                for (var i = 0; i &lt; FILE_TRANSFER_CB_NAMES.length; i++) {
                    var name = FILE_TRANSFER_CB_NAMES[i];
                    me.carrierManager.fileTransfers[fileTransfer.fileTransferId].callbacks[name] = callbacks[name];
                }
            }
            if (onSuccess)
                onSuccess(fileTransfer);
        };
        this.process(_onSuccess, onError, "newFileTransfer", [this.objId, to, fileTransferInfo]);
    };
    CarrierImpl.prototype.generateFileId = function (onSuccess) {
        var _onSuccess = function (ret) {
            if (onSuccess)
                onSuccess(ret.fileId);
        };
        this.process(_onSuccess, null, "generateFileTransFileId", []);
    };
    CarrierImpl.prototype.newSession = function (to, onSuccess, onError) {
        var me = this;
        var _onSuccess = function (ret) {
            var session = new SessionImpl();
            session.objId = ret.id;
            session.peer = ret.peer;
            session.carrier = me;
            session.carrierManager = me.carrierManager;
            if (onSuccess)
                onSuccess(session);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', 'newSession', [this.objId, to]);
    };
    CarrierImpl.prototype.destroy = function (onSuccess, onError) {
        exec(onSuccess, onError, 'CarrierPlugin', 'destroy', [this.objId]);
    };
    return CarrierImpl;
}());
var GroupImpl = /** @class */ (function () {
    function GroupImpl() {
        this.groupId = null;
        this.callbacks = {
            onGroupConnected: null,
            onGroupMessage: null,
            onGroupTitle: null,
            onPeerName: null,
            onPeerListChanged: null
        };
    }
    GroupImpl.prototype.process = function (onSuccess, onError, name, args) {
        var me = this;
        var _onSuccess = function (ret) {
            ret.group = me;
            if (onSuccess)
                onSuccess(ret);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', name, args);
    };
    GroupImpl.prototype.invite = function (friendId, onSuccess, onError) {
        this.process(onSuccess, onError, "inviteGroup", [this.groupId, friendId]);
    };
    GroupImpl.prototype.sendMessage = function (message, onSuccess, onError) {
        this.process(onSuccess, onError, "sendGroupMessage", [this.groupId, message]);
    };
    GroupImpl.prototype.getTitle = function (onSuccess, onError) {
        var _onSuccess = function (ret) {
            var title = ret.groupTitle;
            if (onSuccess)
                onSuccess(title);
        };
        this.process(_onSuccess, onError, "getGroupTitle", [this.groupId]);
    };
    GroupImpl.prototype.setTitle = function (groupTitle, onSuccess, onError) {
        var _onSuccess = function (ret) {
            var title = ret.groupTitle;
            if (onSuccess)
                onSuccess(title);
        };
        this.process(_onSuccess, onError, "setGroupTitle", [this.groupId, groupTitle]);
    };
    GroupImpl.prototype.getPeers = function (onSuccess, onError) {
        var _onSuccess = function (ret) {
            var peers = ret.peers;
            if (onSuccess)
                onSuccess(peers);
        };
        this.process(_onSuccess, onError, "getGroupPeers", [this.groupId]);
    };
    GroupImpl.prototype.getPeer = function (peerId, onSuccess, onError) {
        var _onSuccess = function (ret) {
            var peer = ret.peer;
            if (onSuccess)
                onSuccess(peer);
        };
        this.process(_onSuccess, onError, "getGroupPeer", [this.groupId, peerId]);
    };
    return GroupImpl;
}());
var FileTransferImpl = /** @class */ (function () {
    function FileTransferImpl() {
        this.fileTransferId = null;
        this.callbacks = {
            onStateChanged: null,
            onFileRequest: null,
            onPullRequest: null,
            onData: null,
            onDataFinished: null,
            onPending: null,
            onResume: null,
            onCancel: null
        };
    }
    FileTransferImpl.prototype.process = function (onSuccess, onError, name, args) {
        var me = this;
        var _onSuccess = function (ret) {
            ret.fileTransfer = me;
            if (onSuccess)
                onSuccess(ret);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', name, args);
    };
    FileTransferImpl.prototype.close = function (onSuccess, onError) {
        this.process(onSuccess, onError, "closeFileTrans", [this.fileTransferId]);
    };
    FileTransferImpl.prototype.getFileId = function (filename, onSuccess, onError) {
        var _onSuccess = function (ret) {
            var fileId = ret.fileId;
            if (onSuccess)
                onSuccess(fileId);
        };
        this.process(_onSuccess, onError, "getFileTransFileId", [this.fileTransferId, filename]);
    };
    FileTransferImpl.prototype.getFileName = function (fileId, onSuccess, onError) {
        var _onSuccess = function (ret) {
            var filename = ret.filename;
            if (onSuccess)
                onSuccess(filename);
        };
        this.process(_onSuccess, onError, "getFileTransFileName", [this.fileTransferId, fileId]);
    };
    FileTransferImpl.prototype.connect = function (onSuccess, onError) {
        this.process(onSuccess, onError, "fileTransConnect", [this.fileTransferId]);
    };
    FileTransferImpl.prototype.acceptConnect = function (onSuccess, onError) {
        this.process(onSuccess, onError, "acceptFileTransConnect", [this.fileTransferId]);
    };
    FileTransferImpl.prototype.addFile = function (fileInfo, onSuccess, onError) {
        this.process(onSuccess, onError, "addFileTransFile", [this.fileTransferId, fileInfo]);
    };
    FileTransferImpl.prototype.pullData = function (fileId, offset, onSuccess, onError) {
        this.process(onSuccess, onError, "pullFileTransData", [this.fileTransferId, fileId, offset]);
    };
    FileTransferImpl.prototype.writeData = function (fileId, data, onSuccess, onError) {
        this.process(onSuccess, onError, "writeFileTransData", [this.fileTransferId, fileId, data]);
    };
    FileTransferImpl.prototype.sendFinish = function (fileId, onSuccess, onError) {
        this.process(onSuccess, onError, "sendFileTransFinish", [this.fileTransferId, fileId]);
    };
    FileTransferImpl.prototype.cancelTransfer = function (fileId, status, reason, onSuccess, onError) {
        this.process(onSuccess, onError, "cancelFileTrans", [this.fileTransferId, fileId, status, reason]);
    };
    FileTransferImpl.prototype.pendTransfer = function (fileId, onSuccess, onError) {
        this.process(onSuccess, onError, "pendFileTrans", [this.fileTransferId, fileId]);
    };
    FileTransferImpl.prototype.resumeTransfer = function (fileId, onSuccess, onError) {
        this.process(onSuccess, onError, "resumeFileTrans", [this.fileTransferId, fileId]);
    };
    return FileTransferImpl;
}());
var CarrierManagerImpl = /** @class */ (function () {
    function CarrierManagerImpl() {
        this.carriers = [];
        this.streams = [];
        this.groups = {};
        this.fileTransfers = {};
        this.FriendInviteEvent = [];
        this.FriendInviteCount = 0;
        this.SRCEvent = [];
        this.SRCCount = 0;
        Object.freeze(CarrierManagerImpl.prototype);
        Object.freeze(CarrierImpl.prototype);
        Object.freeze(SessionImpl.prototype);
        Object.freeze(StreamImpl.prototype);
        Object.freeze(GroupImpl.prototype);
        Object.freeze(FileTransferImpl.prototype);
        exec(function () { }, null, 'CarrierPlugin', 'initVal', []);
    }
    //FriendInviteResponseHandler
    CarrierManagerImpl.prototype.addFriendInviteResponseCB = function (callback, carrier) {
        this.FriendInviteCount++;
        this.FriendInviteEvent[this.FriendInviteCount] = new Object;
        this.FriendInviteEvent[this.FriendInviteCount].callback = callback;
        this.FriendInviteEvent[this.FriendInviteCount].carrier = carrier;
        return this.FriendInviteCount;
    };
    //SessionRequestCompleteHandler
    CarrierManagerImpl.prototype.addSessionRequestCompleteCB = function (callback, session) {
        this.SRCCount++;
        this.SRCEvent[this.SRCCount] = new Object;
        this.SRCEvent[this.SRCCount].callback = callback;
        this.SRCEvent[this.SRCCount].session = session;
        return this.SRCCount;
    };
    CarrierManagerImpl.prototype.setListener = function (type, eventCallback) {
        exec(eventCallback, null, 'CarrierPlugin', 'setListener', [type]);
    };
    CarrierManagerImpl.prototype.getVersion = function (onSuccess, onError) {
        exec(onSuccess, onError, 'CarrierPlugin', 'getVersion', []);
    };
    CarrierManagerImpl.prototype.isValidId = function (id, onSuccess, onError) {
        var _onSuccess = function (ret) {
            if (onSuccess)
                onSuccess(ret == "true" ? true : false);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', 'isValidAddress', [id]);
    };
    CarrierManagerImpl.prototype.isValidAddress = function (address, onSuccess, onError) {
        var _onSuccess = function (ret) {
            if (onSuccess)
                onSuccess(ret == "true" ? true : false);
        };
        exec(_onSuccess, onError, 'CarrierPlugin', 'isValidAddress', [address]);
    };
    CarrierManagerImpl.prototype.getIdFromAddress = function (address, onSuccess, onError) {
        exec(onSuccess, onError, 'CarrierPlugin', 'getIdFromAddress', [address]);
    };
    CarrierManagerImpl.prototype.createObject = function (callbacks, options, onSuccess, onError) {
        var _this = this;
        this.setListener(CARRIER, function (event) {
            event.carrier = _this.carriers[event.id];
            if (event.carrier) {
                //        event.id = null;
                if (event.carrier.callbacks[event.name]) {
                    event.carrier.callbacks[event.name](event);
                }
            }
            else {
                alert(event.name);
            }
        });
        this.setListener(STREAM, function (event) {
            event.stream = this.streams[event.id];
            event.id = null;
            if (event.stream &amp;&amp; event.stream.callbacks[event.name]) {
                event.stream.callbacks[event.name](event);
            }
        });
        this.setListener(FRIEND_INVITE, function (event) {
            var id = event.id;
            event.id = null;
            if (_this.FriendInviteEvent[id].callback) {
                event.carrier = _this.FriendInviteEvent[id].carrier;
                _this.FriendInviteEvent[id].callback(event);
            }
        });
        this.setListener(SESSION, function (event) {
            var id = event.id;
            event.id = null;
            if (_this.SRCEvent[id].callback) {
                event.session = _this.SRCEvent[id].session;
                _this.SRCEvent[id].callback(event);
            }
        });
        this.setListener(GROUP, function (event) {
            var group = _this.groups[event.groupId];
            if (group) {
                if (group.callbacks[event.name]) {
                    group.callbacks[event.name](event);
                }
            }
            else {
                alert(event.name);
            }
        });
        this.setListener(FILE_TRANSFER, function (event) {
            var fileTransfer = _this.fileTransfers[event.fileTransferId];
            if (fileTransfer) {
                if (fileTransfer.callbacks[event.name]) {
                    fileTransfer.callbacks[event.name](event);
                }
            }
            else {
                alert(event.name);
            }
        });
        var carrier = new CarrierImpl();
        var me = this;
        var _onSuccess = function (ret) {
            carrier.objId = ret.id;
            carrier.nodeId = ret.nodeId;
            carrier.userId = ret.userId;
            carrier.address = ret.address;
            carrier._nospam = ret.nospam;
            carrier._presence = ret.presence;
            carrier.carrierManager = me;
            me.carriers[carrier.objId] = carrier;
            if (onSuccess)
                onSuccess(carrier);
        };
        if (typeof (options) == "undefined" || options == null) {
            options = this.options;
        }
        if (typeof (callbacks) != "undefined" &amp;&amp; callbacks != null) {
            for (var i = 0; i &lt; CARRIER_CB_NAMES.length; i++) {
                var name = CARRIER_CB_NAMES[i];
                carrier.callbacks[name] = callbacks[name];
            }
        }
        var configstring = JSON.stringify(options);
        exec(_onSuccess, onError, 'CarrierPlugin', 'createObject', ["im", configstring]);
    };
    return CarrierManagerImpl;
}());
var carrierManager = new CarrierManagerImpl();
module.exports = carrierManager;
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


	<span class="copyright">
	Elastos Foundation Â© 2017-2019
	</span>

<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a>
	
		on Mon Dec 2nd 2019
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : true,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>
